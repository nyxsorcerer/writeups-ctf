package main

// $ go build -buildmode=c-shared -o ../http/liblicense.so liblicense.go

import (
	"C"
	"math/rand"
)

var crc_table = []int64{
	0x00, 0x37, 0x6E, 0x59, 0xDC, 0xEB, 0xB2, 0x85, 0x8F, 0xB8, 0xE1, 0xD6, 0x53, 0x64, 0x3D, 0x0A,
	0x29, 0x1E, 0x47, 0x70, 0xF5, 0xC2, 0x9B, 0xAC, 0xA6, 0x91, 0xC8, 0xFF, 0x7A, 0x4D, 0x14, 0x23,
	0x52, 0x65, 0x3C, 0x0B, 0x8E, 0xB9, 0xE0, 0xD7, 0xDD, 0xEA, 0xB3, 0x84, 0x01, 0x36, 0x6F, 0x58,
	0x7B, 0x4C, 0x15, 0x22, 0xA7, 0x90, 0xC9, 0xFE, 0xF4, 0xC3, 0x9A, 0xAD, 0x28, 0x1F, 0x46, 0x71,
	0xA4, 0x93, 0xCA, 0xFD, 0x78, 0x4F, 0x16, 0x21, 0x2B, 0x1C, 0x45, 0x72, 0xF7, 0xC0, 0x99, 0xAE,
	0x8D, 0xBA, 0xE3, 0xD4, 0x51, 0x66, 0x3F, 0x08, 0x02, 0x35, 0x6C, 0x5B, 0xDE, 0xE9, 0xB0, 0x87,
	0xF6, 0xC1, 0x98, 0xAF, 0x2A, 0x1D, 0x44, 0x73, 0x79, 0x4E, 0x17, 0x20, 0xA5, 0x92, 0xCB, 0xFC,
	0xDF, 0xE8, 0xB1, 0x86, 0x03, 0x34, 0x6D, 0x5A, 0x50, 0x67, 0x3E, 0x09, 0x8C, 0xBB, 0xE2, 0xD5,
	0x7F, 0x48, 0x11, 0x26, 0xA3, 0x94, 0xCD, 0xFA, 0xF0, 0xC7, 0x9E, 0xA9, 0x2C, 0x1B, 0x42, 0x75,
	0x56, 0x61, 0x38, 0x0F, 0x8A, 0xBD, 0xE4, 0xD3, 0xD9, 0xEE, 0xB7, 0x80, 0x05, 0x32, 0x6B, 0x5C,
	0x2D, 0x1A, 0x43, 0x74, 0xF1, 0xC6, 0x9F, 0xA8, 0xA2, 0x95, 0xCC, 0xFB, 0x7E, 0x49, 0x10, 0x27,
	0x04, 0x33, 0x6A, 0x5D, 0xD8, 0xEF, 0xB6, 0x81, 0x8B, 0xBC, 0xE5, 0xD2, 0x57, 0x60, 0x39, 0x0E,
	0xDB, 0xEC, 0xB5, 0x82, 0x07, 0x30, 0x69, 0x5E, 0x54, 0x63, 0x3A, 0x0D, 0x88, 0xBF, 0xE6, 0xD1,
	0xF2, 0xC5, 0x9C, 0xAB, 0x2E, 0x19, 0x40, 0x77, 0x7D, 0x4A, 0x13, 0x24, 0xA1, 0x96, 0xCF, 0xF8,
	0x89, 0xBE, 0xE7, 0xD0, 0x55, 0x62, 0x3B, 0x0C, 0x06, 0x31, 0x68, 0x5F, 0xDA, 0xED, 0xB4, 0x83,
	0xA0, 0x97, 0xCE, 0xF9, 0x7C, 0x4B, 0x12, 0x25, 0x2F, 0x18, 0x41, 0x76, 0xF3, 0xC4, 0x9D, 0xAA}

var license = [][]int64{
	{0x63d9c49eaf33415f, 0x4c33ff4db65f3613, 0x688d8fa35b7d59a4, 0x632fe1a05403527d, 0x68a0ab5416ef70e5},
	{0x2a9639a6b4ada218, 0x268f239dc6e330a0, 0x184b3caa1822a043, 0x202d3f84ffae1efa, 0x2e6b8145c9df9452},
	{0x3f42d19bb79c4f6, 0x617536589c3ce75c, 0x579caddf445bf86e, 0x3b7191e652109458, 0x596bc5a2f813ba91},
	{0x150a569e62edd151, 0x6e2a0ed802616e76, 0x566adc429b10368a, 0x7cddba29ff022551, 0x19a73b4caccbe74c},
	{0x1a85b2ebd33915b6, 0x21e473d51cbe915f, 0x18f0a1452f186224, 0x62f3043890fb1a00, 0x3da50a9a4061a856},
	{0x3e38e741e6556989, 0x28e16a150e4e7e17, 0x445bc89221ea2d53, 0x59a9b092a6de5f70, 0x26a12ab1fe2275c1},
	{0x1758e4cf6070479d, 0x6ed2422497dcc0a1, 0x340fafa6931164d2, 0x2a1efb70b2da73a0, 0x2d6b88aea6536362},
	{0x3e38e741e6556989, 0x28e16a150e4e7e17, 0x445bc89221ea2d53, 0x59a9b092a6de5f70, 0x26a12ab1fe2275c1},
	{0x3ba7aa8d08213ebe, 0x2838a6f062f32b7a, 0x7eb7e561f8197f8b, 0x268b1d9c3a6e14a0, 0x52652e32274701ab},
	{0x104a0308478fb973, 0x2f392904f5af6d19, 0x52b16eb319d64de4, 0x2c1743e85b47666b, 0x15a4ca31f68acb4c},
	{0x7cac75dc32808aa4, 0x6ac0aa5b76129530, 0x605edc967cf08344, 0x325a9e4f706026b8, 0x71a654b1329315af},
	{0x257c654e9381717e, 0x65657df1f906e958, 0x19e49f7ca5ef2611, 0xfce061a75d2ad7, 0xd6242792f381466},
	{0x445dd7a85b230ad, 0x12b7641497f46d6b, 0x44a3e2c3c0533460, 0x5d252d1df0631271, 0x396e5b5537875641},
	{0x77e3924f9bad7fb8, 0x4ff1245708f9884e, 0x3d841710ca9cce3b, 0x2dcc3057a6c3bf9c, 0x7d7264d86d7cbe45},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x1f26ce1d9c7d80e2, 0xd11fed481ca00af, 0x2c1f2e75b68e3ec2, 0x794fc21fc616d79a, 0x2aa4b38941c0802d},
	{0x5bc09f53be238a2f, 0x1fb7ff6d4964619e, 0x5f18d572f98e0c2, 0xff3a08ff68912ce, 0x3db0de36c97cdb47},
	{0x1c1857d0fdadbc81, 0x22a85034aa3c6423, 0x768dd8bef5950fec, 0x10152b7f5e3e5800, 0x51623d3c89945c6c},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x21b486475e71daa, 0x5c5aa3ac60dd1520, 0x6ffacf1d905b4a16, 0xdd400c0532a5958, 0x56baa237166667c},
	{0xa7bafd3c2cb1328, 0x2f09d0658eb23b7d, 0x74f804e93ab51f9c, 0x76f5158e7a5d2ccc, 0x4166f94f8ca05727},
	{0x445dd7a85b230ad, 0x12b7641497f46d6b, 0x44a3e2c3c0533460, 0x5d252d1df0631271, 0x396e5b5537875641},
	{0x21b486475e71daa, 0x5c5aa3ac60dd1520, 0x6ffacf1d905b4a16, 0xdd400c0532a5958, 0x56baa237166667c},
	{0x2c5902f43f886ca5, 0x7e2d643df02b3cae, 0x6a3cdbfbb5c9285, 0x2bb2cbd3e24df9bf, 0x1a6f733c02f3537},
	{0x11dc2d2d821fdbe4, 0x1d4e434cc3a45f5b, 0x40f16181b8fcdd0d, 0x59e047a2d7bd2081, 0x4a619cf8ed945ab5},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x54d1d902d9253649, 0x61689bde0060a838, 0x462c2647de1e9719, 0x330e8e66c7ce548, 0x9666ce98943ffc6},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x5f52b5510e85c4fa, 0x248b848cc10214ba, 0x638ed0a0e6d5cf06, 0x7b5d099586c35d9d, 0x61aa6cd5efef975b},
	{0x1c1857d0fdadbc81, 0x22a85034aa3c6423, 0x768dd8bef5950fec, 0x10152b7f5e3e5800, 0x51623d3c89945c6c},
	{0x39d9e4bf0616b429, 0x4ed42e4ebf5f4066, 0x2e2536807e094d55, 0x1b0b744e0bf049da, 0x7eb42b72152df936},
	{0x11dc2d2d821fdbe4, 0x1d4e434cc3a45f5b, 0x40f16181b8fcdd0d, 0x59e047a2d7bd2081, 0x4a619cf8ed945ab5},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x5f52b5510e85c4fa, 0x248b848cc10214ba, 0x638ed0a0e6d5cf06, 0x7b5d099586c35d9d, 0x61aa6cd5efef975b},
	{0x11dc2d2d821fdbe4, 0x1d4e434cc3a45f5b, 0x40f16181b8fcdd0d, 0x59e047a2d7bd2081, 0x4a619cf8ed945ab5},
	{0x21b486475e71daa, 0x5c5aa3ac60dd1520, 0x6ffacf1d905b4a16, 0xdd400c0532a5958, 0x56baa237166667c},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x64ab3dae0cd9b216, 0x8b61c71521efd5a, 0x65958390014695d6, 0x8cf40b86c74351a, 0x4a73f9f5ad910c95},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x630965c1d6407904, 0x4084c4c6ee7a96f9, 0x69363b6172111af9, 0x2b75486c83204144, 0x356acb2aa462ec28},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x60b60c019cba2bc6, 0x242a68d0d0ed6756, 0x4b2f9b0583567d4e, 0x2c5b88b830a42c1d, 0x355a9a180e8b5370},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x54d1d902d9253649, 0x61689bde0060a838, 0x462c2647de1e9719, 0x330e8e66c7ce548, 0x9666ce98943ffc6},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x445dd7a85b230ad, 0x12b7641497f46d6b, 0x44a3e2c3c0533460, 0x5d252d1df0631271, 0x396e5b5537875641},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x21b486475e71daa, 0x5c5aa3ac60dd1520, 0x6ffacf1d905b4a16, 0xdd400c0532a5958, 0x56baa237166667c},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x7cac75dc32808aa4, 0x6ac0aa5b76129530, 0x605edc967cf08344, 0x325a9e4f706026b8, 0x71a654b1329315af},
	{0x11dc2d2d821fdbe4, 0x1d4e434cc3a45f5b, 0x40f16181b8fcdd0d, 0x59e047a2d7bd2081, 0x4a619cf8ed945ab5},
	{0x5f52b5510e85c4fa, 0x248b848cc10214ba, 0x638ed0a0e6d5cf06, 0x7b5d099586c35d9d, 0x61aa6cd5efef975b},
	{0x5f52b5510e85c4fa, 0x248b848cc10214ba, 0x638ed0a0e6d5cf06, 0x7b5d099586c35d9d, 0x61aa6cd5efef975b},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x5844be3e98060099, 0x3ef5f197d4b3f824, 0x56874db431044021, 0x5de1b0e647b8ee42, 0xe6d3b491dc1f7d9},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x194f52b688edf592, 0x46cf8d106d81d0bc, 0x451df5c6bf34bf3e, 0x431fac08946477e0, 0x3dab9fa2e6cd2fca},
	{0x39d9e4bf0616b429, 0x4ed42e4ebf5f4066, 0x2e2536807e094d55, 0x1b0b744e0bf049da, 0x7eb42b72152df936},
	{0x11dc2d2d821fdbe4, 0x1d4e434cc3a45f5b, 0x40f16181b8fcdd0d, 0x59e047a2d7bd2081, 0x4a619cf8ed945ab5},
	{0x3c72ac301b28aaf5, 0x546ccef82278937a, 0x1bc4ce4c7aa23b1d, 0x4863cd941bf213ba, 0x526a55136eb2ad4b},
	{0x66e4632ae01309c0, 0x4282e22c9b2d53cf, 0x7d5c8199f65ad8fa, 0x4c624480ea95c518, 0x3d5c132351f794a7},
	{0x3dc9c47d0a9cebd8, 0x691fc9faf27f3b4b, 0x10d8a1c7773e9aa9, 0x9d6c3d80f9b94f7, 0x11b5c03d9b4d2247}}

//export licenseCheck
func licenseCheck(inp *C.char) int {
	for x, char := range C.GoString(inp) {
		rand.Seed(crc_table[(char+0x1337)&0xff])
		for y := 0; y < 5; y++ {
			if int64(rand.Int()) != int64(license[x][y]) {
				return 0
			}
		}
	}
	return 1
}

func main() {}
